# 数据源 API 数据格式说明

本扩展支持两个数据源：腾讯财经和新浪财经。它们返回的数据格式不同，以下是详细说明：

## 新浪财经数据接口

**请求URL格式：**
```
http://hq.sinajs.cn/list=sh601006
http://hq.sinajs.cn/list=sz000001
http://hq.sinajs.cn/list=sh601006,sz000001  // 支持批量查询
```

**返回数据示例：**
```
var hq_str_sh601006="大秦铁路,27.55,27.25,26.91,27.55,26.20,26.91,26.92,22114263,589824680,4695,26.91,57590,26.90,14700,26.89,14300,26.88,15100,26.87,3100,26.92,8900,26.93,14230,26.94,25150,26.95,15220,26.96,2008-01-11,15:05:32";
```

**数据字段说明（使用逗号分隔）：**

| 字段索引 | 字段内容       | 含义           | 单位 |
| -------- | -------------- | -------------- | ---- |
| 0        | 大秦铁路       | 股票名称       | -    |
| 1        | 27.55          | 今日开盘价     | 元   |
| 2        | 27.25          | 昨日收盘价     | 元   |
| 3        | 26.91          | 当前价格       | 元   |
| 4        | 27.55          | 今日最高价     | 元   |
| 5        | 26.20          | 今日最低价     | 元   |
| 6        | 26.91          | 竞买价（买一价）| 元   |
| 7        | 26.92          | 竞卖价（卖一价）| 元   |
| 8        | 22114263       | 成交量         | 股   |
| 9        | 589824680      | 成交金额       | 元   |   
| 10       | 4695           | 买一数量（手） | 手   |
| 11       | 26.91          | 买一报价       | 元   |
| 12       | 57590          | 买二数量（手） | 手   |
| 13       | 26.90          | 买二报价       | 元   |
| 14-19    | ...            | 买三至买五     | -    |
| 20-29    | ...            | 卖一至卖五     | -    |
| 30       | 2008-01-11     | 日期           | -    |
| 31       | 15:05:32       | 时间           | -    |

**注意事项：**
- 新浪API支持批量查询，多个股票代码用逗号分隔
- **重要**：成交量索引8的单位是"股"（不是"手"），需要除以100转换为"手"（1手=100股）
- 成交金额单位为"元"
- **重要**：新浪财经接口可能需要设置请求头才能正常访问：
  - `Referer`: `http://finance.sina.com.cn`（必需）
  - `User-Agent`: 浏览器标识（推荐）
- 如果遇到 403 或 404 错误，通常是缺少必要的请求头导致的

## 腾讯财经数据接口

**请求URL格式：**
```
http://qt.gtimg.cn/q=sz000858
http://qt.gtimg.cn/q=sh600000
```

**返回数据示例：**
```
v_sz000858="51~五 粮 液~000858~27.78~27.60~27.70~417909~190109~227800~27.78~492~27.77~332~27.76~202~27.75~334~27.74~291~27.79~305~27.80~570~27.81~269~27.82~448~27.83~127~15:00:13/27.78/4365/S/12124331/24602|14:56:55/27.80/14/S/38932/24395|14:56:52/27.81/116/B/322585/24392|14:56:49/27.80/131/S/364220/24385|14:56:46/27.81/5/B/13905/24381|14:56:43/27.80/31/B/86199/24375~20121221150355~0.18~0.65~28.11~27.55~27.80/413544/1151265041~417909~116339~1.10~10.14~~28.11~27.55~2.03~1054.39~1054.52~3.64~30.36~24.84~";
```

**数据字段说明（使用 ~ 分隔）：**

| 字段索引 | 字段内容       | 含义               | 单位 |
| -------- | -------------- | ------------------ | ---- |
| 0        | 51             | 未知               | -    |
| 1        | 五 粮 液       | 股票名称           | -    |
| 2        | 000858         | 股票代码           | -    |
| 3        | 27.78          | 当前价格           | 元   |
| 4        | 27.60          | 昨日收盘价         | 元   |
| 5        | 27.70          | 今日开盘价         | 元   |
| 6        | 417909         | 成交量（手）       | 手   |
| 7        | 190109         | 外盘               | 手   |
| 8        | 227800         | 内盘               | 手   |
| 9        | 27.78          | 买一报价           | 元   |
| 10       | 492            | 买一数量（手）     | 手   |
| 11-18    | ...            | 买二至买五         | -    |
| 19-28    | ...            | 卖一至卖五         | -    |
| 29       | 15:00:13/...   | 最近逐笔成交       | -    |
| 30       | 20121221150355 | 时间戳             | -    |
| 31       | 0.18           | 涨跌               | 元   |
| 32       | 0.65           | 涨跌幅（百分比）   | %    |
| 33       | 28.11          | 最高价             | 元   |
| 34       | 27.55          | 最低价             | 元   |
| 35       | 27.80/413544/1151265041 | 价格/成交量/成交额 | -    |
| 36       | 417909         | 成交量（手）       | 手   |
| 37       | 116339         | 成交额（万）       | 万元 |
| 38       | 1.10           | 换手率             | %    |
| 39       | 10.14          | 市盈率             | -    |
| 40       |                | 未知               | -    |
| 41       | 28.11          | 最高价             | 元   |
| 42       | 27.55          | 最低价             | 元   |
| 43       | 2.03           | 振幅               | %    |
| 44       | 1054.39        | 流通市值           | 亿元 |
| 45       | 1054.52        | 总市值             | 亿元 |
| 46       | 3.64           | 市净率             | -    |
| 47       | 30.36          | 涨停价             | 元   |
| 48       | 24.84          | 跌停价             | 元   |

**注意事项：**
- 腾讯API每次只能查询一个股票代码
- 成交量单位为"手"（1手=100股）
- 成交额索引37单位为"万元"，需要乘以10000转换为元
- 涨跌幅百分比在索引32，直接使用无需计算

## 两个数据源的对比

| 特性 | 新浪财经 | 腾讯财经 |
|------|---------|---------|
| 批量查询 | ✅ 支持 | ❌ 不支持 |
| 数据字段数 | 32个字段 | 49个字段 |
| 分隔符 | 逗号 (`,`) | 波浪号 (`~`) |
| 涨跌幅 | 需要计算 | 直接提供（索引32） |
| 成交量单位 | 股（索引8，需除以100转换为手） | 手 |
| 成交额单位 | 元 | 万元（索引37） |

## 参考资料

- 新浪财经实时股票数据接口示例：([blog.51cto.com](https://blog.51cto.com/u_16097040/6245362))
- 腾讯财经接口示例：([cnblogs.com](https://www.cnblogs.com/shclbear/p/16678012.html))

## 免责声明

以上数据格式说明仅供参考，实际API返回格式可能因时间不同而有所变化。具体数据格式和字段含义请参考新浪财经和腾讯财经的官方文档或相关技术博客。

